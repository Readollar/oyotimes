---
// src/components/PopularLocations.astro
import { getCollection } from 'astro:content';
import CardLocation from './cards/CardLocation.astro';

// 1. Fetch all places
const allPlaces = await getCollection('places');

// 2. Pick 3 places to show
// (You could also filter by p.data.isEditorPick === true if you want specific ones)
const locations = allPlaces.slice(0, 3);
---

<section class="container py-8 md:py-12">
  
  <div class="text-center max-w-2xl mx-auto mb-10">
    <h2 class="font-merri text-2xl md:text-4xl font-bold text-primary mb-4">
      Popular Locations & Businesses
    </h2>
    <p class="text-md text-muted">
      Discover popular places and verified businesses in Oyo.
    </p>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    {locations.map(place => (
      <CardLocation 
        href={`/places/${place.slug}/`}
        imgSrc={place.data.imgSrc}
        title={place.data.title}
        subtitle={place.data.location}
      />
    ))}
  </div>

  <div class="text-center mt-10">
    <a href="/places" class="inline-block border-2 border-primary text-text-primary font-bold py-2 px-6 rounded-full hover:bg-primary hover:text-white transition-colors">
      View All Places
    </a>
  </div>
</section>