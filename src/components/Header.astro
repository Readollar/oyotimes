---
// src/components/Header.astro
// This is the cleaned-up, correct version.

// 1. We ONLY get 'activeId' from the props. Defaults to "home".
const { activeId = "home" } = Astro.props;

// 2. We ONLY use your 'navItems' list.
// I've fixed the hrefs to match the dynamic category page.
const navItems = [
  { name: "Home", href: "/", id: "home" },
  { name: "Business", href: "/category/business", id: "business" },
  { name: "Politics", href: "/category/politics", id: "politics" },
  { name: "Tech", href: "/category/tech", id: "tech" },
  { name: "Education", href: "/category/education", id: "education" },
  { name: "Sports", href: "/category/sports", id: "sports" },
  { name: "Events", href: "/events", id: "events" },
  { name: "Places", href: "/places", id: "places" },
  { name: "Community Voices", href: "/community", id: "community" },
  { name: "Monarch's Desk", href: "/monarch", id: "monarch" },
  //{ name: "About", href: "/about", id: "about" },
];
// 2. Dropdown now only has utility links
const dropdownItems = [
  { name: "About", href: "/about", id: "about" },
  { name: "Bookmarks", href: "/bookmarks", id: "bookmarks" },
  { name: "Submit Article", href: "/submit", id: "submit" },
];

// 3. Check if any dropdown item is active
const isDropdownActive = dropdownItems.some(item => item.id === activeId);
---

<header class="oy-header" role="banner">
    <div class="container head-bar">
    <div class="head-inner">
      <div class="date-left" aria-hidden="false">
        <img src="/icons/icon-world.svg" alt="" class="icon-world" />
        <span id="oy-current-date" class="date-text">Loading date...</span>
      </div>
      <div class="brand">
        <img src="/img/logos/logo-full.svg" alt="OyoTimes" class="brand-logo" />
      </div>
      <div class="right-actions">

        <form action="/search" method="GET" class="search-form">
          <label for="header-search" class="sr-only">Search</label>
          <input 
            type="search" 
            name="q" 
            id="header-search" 
            class="search-input" 
            placeholder="Search..."
          />
  	 	  <button type="submit" class="search-btn" aria-label="Search">
  	 	    <img src="/icons/icon-search.svg" alt="Search" />
  	 	  </button> </form>
        <button class="hamburger" id="oy-hamburger" aria-label="Open menu" aria-expanded="false">
          <span></span><span></span><span></span>
        </button>
      </div>
    </div>
  </div>
</header>

<div class="nav-band" id="oy-nav-band">
  <div class="container nav-inner">
    <nav class="main-nav" role="navigation" aria-label="Main">
      <ul class="nav-list">
        {navItems.map(item => (
  	 	   <li class={`nav-item ${item.id === activeId ? 'active' : ''}`}>
  	 	 	 <a href={item.href} class="nav-link">{item.name}</a>
  	 	   </li>
  	 	 ))}

        <li class={`nav-item dropdown-container ${isDropdownActive ? 'active' : ''}`}>
          <a href="#" class="nav-link" onclick="event.preventDefault();">
            More &darr;
          </a>
          <ul class="dropdown-menu">
            {dropdownItems.map(item => (
              <li class={`dropdown-item ${item.id === activeId ? 'active' : ''}`}>
                <a href={item.href} class="nav-link">{item.name}</a>
              </li>
            ))}
          </ul>
        </li>
      </ul>
    </nav>
  </div>
</div>

<script>
  // live date
  (function () {
    const el = document.getElementById("oy-current-date");
    if (!el) return;
    const now = new Date();
    const opts = { weekday: "long", year: "numeric", month: "long", day: "numeric" };
    el.textContent = now.toLocaleDateString(undefined, opts);
  })();

  // toggles for mobile nav
  (function () {
    const btn = document.getElementById("oy-hamburger");
    const navBand = document.getElementById("oy-nav-band");
    if (!btn || !navBand) return;
    btn.addEventListener("click", () => {
      const expanded = btn.getAttribute("aria-expanded") === "true";
      btn.setAttribute("aria-expanded", String(!expanded));
      navBand.classList.toggle("open");
    });
  })();
</script>

<style>
  /* Your existing <style> block is perfect. I've copied it here. */
:root {
  --side-margin: 120px;
  --gutter: 24px;
}
.oy-header {
 position: sticky;
 top: 0;
 z-index: 120;
 background: var(--color-bg-primary);
 box-shadow: 0 1px 0 rgba(0,0,0,0.03);
}
.head-bar {
 background: var(--color-bg-primary);
 color: var(--color-text-secondary);
 font-family: var(--font-body);
 font-size: var(--font-paragraph-size);
}
.head-inner {
 display: grid;
 grid-template-columns: 1fr auto 1fr;
 align-items: center;
 justify-content: space-between;
 padding: 18px 0;
}
.date-left {
 display: flex;
 align-items: center;
 gap: 12px;
}
.icon-world { width: 18px; height: 18px; opacity: 0.9 }
.date-text { color: var(--color-text-secondary); }
.brand {
 grid-column: 2 / 3;
 display:flex;
 align-items:center;
 gap: 18px;
 justify-self:center;
}
.brand-logo { width: 200px; height: auto; display:block; }
.right-actions {
 justify-self: end;
 display: flex;
 align-items: center;
 gap: 12px;
}
.utility-link {
 display: block;
 font-size: 14px;
 font-weight: 600;
 color: var(--color-text-primary);
 text-decoration: none;
 transition: color 0.15s ease;
}
.utility-link:hover {
 color: var(--color-base-red-942414);
}
.search-form {
 display: flex;
 align-items: center;
 background: #f5f5f5;
 border-radius: 8px;
 padding-left: 10px;
 overflow: hidden;
}
.search-input {
 border: none;
 background: transparent;
 outline: none;
 padding: 0;
 width: 0; /* Hidden by default */
 transition: width 0.3s ease;
}
.search-form:focus-within .search-input,
.search-input:not(:placeholder-shown) {
 width: 150px; /* Expand on focus or when it has text */
 padding-right: 5px;
}
.search-btn {
 background: #f5f5f5;
 border: none;
 padding: 10px;
 border-radius: 8px;
 display: inline-flex;
 align-items:center;
 justify-content:center;
 cursor: pointer;
}
.search-btn img { width: 18px; height:18px; }

.hamburger {
 display: none;
 background: none;
 border: none;
 width: 40px;
 height: 34px;
 padding: 6px;
 flex-direction: column;
 justify-content: space-between;
 gap: 4px;
 cursor: pointer;
}
.hamburger span {
 display: block;
 height: 3px;
 background: var(--color-text-primary);
 border-radius: 3px;
}
.nav-band {
 background: #e5e5e5;
 border-top: 1px solid var(--color-divider);
 border-bottom: 1px solid var(--color-divider);
}
.nav-inner {
 padding: 12px 0;
}
.main-nav { width: 100%; }
.nav-list {
 display: flex;
 gap: calc(var(--gutter));
 align-items: center;
 justify-content: center;
 margin: 0;
 padding: 0;
 list-style: none;
}
.nav-item { }
.nav-link {
 text-decoration: none;
 color: var(--color-text-primary);
 font-family: var(--font-body-md-family);
 font-size: var(--font-body-md-size);
 font-weight: 500;
 padding: 6px 2px;
 transition: color .15s ease;
}
.nav-item.active .nav-link,
.nav-link:hover {
 color: var(--color-base-red-942414);
}

/* Styles for the Dropdown */
  .dropdown-container {
    position: relative;
  }
  .dropdown-menu {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    min-width: 240px;
    background: var(--color-bg-primary);
    border: 1px solid var(--color-divider);
    border-top: none;
    box-shadow: var(--shadow-soft);
    z-index: 100;
    list-style: none;
    padding: 8px;
    margin: 0;
  }
  .dropdown-item {
    width: 100%;
  }
  .dropdown-item .nav-link {
    width: 100%;
    display: block;
    padding: 8px 12px;
    border-radius: 4px;
  }
  .dropdown-item .nav-link:hover {
    background: var(--color-bg-alt);
    color: var(--color-base-red-942414);
  }
  .dropdown-item.active .nav-link {
    background: var(--color-bg-alt);
    color: var(--color-base-red-942414);
  }
  
  .dropdown-container:hover .dropdown-menu {
    display: block;
  }

@media (max-width: 980px) {
:root { --side-margin: 24px; } 
.head-inner { grid-template-columns: 1fr auto; }
.brand { grid-column: 1 / 2; justify-self: start; }
.right-actions { justify-self: end; }
.hamburger { display: inline-flex; }

    /* 1. Hide the nav list by default */
.nav-list { 
 display: none;
}
.nav-inner {
  padding: 0px;
}

    /* 2. When the menu is open... */
.nav-band.open {
      /* Allows the list to be positioned relative to the nav-band */
 position: relative; 
}
.nav-band.open .nav-list {
 display: flex;
 flex-direction: column; /* Stack the links vertically */
 align-items: flex-start; /* Align text to the left */
      
      /* Make it a full-width dropdown */
 position: absolute;
 top: 100%; /* Position it right below the nav-band */
 left: 0;
 right: 0;
      
      /* Style the dropdown container */
 background: var(--color-bg-primary); /* Use your main white bg */
 padding: var(--gutter); /* Use your 24px gutter for padding */
 box-shadow: var(--shadow-soft); /* Add a nice shadow */
 border-top: 1px solid var(--color-border-default);
}
.nav-band.open .nav-item {
 width: 100%; /* Make each link take the full width */
}
.nav-band.open .nav-link {
 padding: 12px 0; /* Add some vertical padding to each link */
}
.utility-link {
 display: none;
}

/* Mobile Dropdown Logic */
    .dropdown-container {
      width: 100%;
    }
    .dropdown-container .nav-link {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
    }
    .dropdown-container:hover .dropdown-menu,
    .dropdown-container .dropdown-menu {
      display: block;
      position: static;
      box-shadow: none;
      border: none;
      padding: 0 0 0 16px; /* Indent the sub-menu */
    }
    .dropdown-item .nav-link {
      color: var(--color-text-muted);
      font-size: 15px;
    }
}

@media (min-width: 1440px) {
.container { min-width: 1200px; margin-left: auto; margin-right: auto; }
}

@media (max-width: 768px) {
body {
 font-size: var(--font-body-sm-size);
 line-height: var(--font-body-sm-line);
 padding-inline: calc(var(--grid-gutter));
}
.container {
 padding-left: 0px;  /* On mobile, margin equals the gutter width */
 padding-right: 0px;
}
.head-inner {
 align-items: center;
 justify-content: space-between;
 padding-inline: 16px;
}
div.date-left {
 margin-bottom: 16px;
}
div.container.head-bar {
  padding-block: 0px;
}
div#oy-nav-band.container.nav-band {
  padding: 0px;
}

}
</style>